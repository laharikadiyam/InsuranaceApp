<div class="claim-management">
  <div class="card shadow mb-4">
    <div class="card-header py-3 d-flex justify-content-between align-items-center">
      <h6 class="m-0 font-weight-bold text-primary">
        <i class="fas fa-clipboard-list me-2"></i>Claim Management
      </h6>
      <div class="d-flex align-items-center">
        <select class="form-select me-2" [(ngModel)]="selectedStatus" style="width: auto;">
          <option value="">All Status</option>
          <option value="PENDING">Pending</option>
          <option value="APPROVED">Approved</option>
          <option value="REJECTED">Rejected</option>
        </select>
        <button class="btn btn-primary btn-sm" (click)="loadClaims()" [disabled]="isLoading">
          <i class="fas fa-sync-alt"></i> Refresh
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>
  <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>

  <div *ngIf="isLoading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div *ngIf="!isLoading && getFilteredClaims().length === 0" class="text-center text-muted py-5">
    <i class="fas fa-clipboard fa-3x mb-3"></i>
    <h5>No claims found</h5>
    <p>There are no claims to display.</p>
  </div>

  <div *ngIf="!isLoading && getFilteredClaims().length > 0">
    <div class="table-responsive">
      <table class="table table-bordered table-hover">
        <thead class="table-light">
          <tr>
            <th>Claim ID</th>
            <th>User ID</th>
            <th>Purchase ID</th>
            <th>Status</th>
            <th>Uploaded At</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let claim of getFilteredClaims()">
            <td>{{ getClaimId(claim) }}</td>
            <td>{{ getUserId(claim) }}</td>
            <td>{{ getPurchaseId(claim) }}</td>
            <td>
              <span [class]="getStatusBadgeClass(claim.claimStatus)">
                {{ claim.claimStatus }}
              </span>
            </td>
            <td>{{ claim.uploadedAt | date:'medium' }}</td>
            <td>
              <div class="btn-group" role="group" *ngIf="claim.claimStatus === 'PENDING'">
                <button class="btn btn-sm btn-success" (click)="approveClaim(claim)" [disabled]="isLoading">
                  <i class="fas fa-check"></i> Approve
                </button>
                <button class="btn btn-sm btn-danger" (click)="rejectClaim(claim)" [disabled]="isLoading">
                  <i class="fas fa-times"></i> Reject
                </button>
              </div>
              <span *ngIf="claim.claimStatus !== 'PENDING'" class="text-muted">
                {{ claim.claimStatus === 'APPROVED' ? 'Approved' : 'Rejected' }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
